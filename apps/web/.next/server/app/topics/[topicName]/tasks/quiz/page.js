(()=>{var e={};e.id=493,e.ids=[493],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14276:()=>{},18878:(e,t,s)=>{Promise.resolve().then(s.bind(s,26151))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20685:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(38828);s(14276);let a={title:"Unity Voice",description:"Unity Voice app"};function n({children:e}){return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{className:"antialiased",children:e})})}},26151:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(13486),a=s(60159),n=s(2984),l=s(49989),o=s.n(l),i=s(49704),d=s(70173),c=s(58369);function m(){let{isAuthenticated:e,isLoading:t,user:s}=(0,c.A)(),l=(0,n.useRouter)(),m=(0,n.useParams)(),x=(0,n.useSearchParams)(),u=m?.topicName,h=x?.get("level")||"1",p=x?.get("taskId"),[g,b]=(0,a.useState)(0),[f,v]=(0,a.useState)(""),[j,N]=(0,a.useState)(0),[y,w]=(0,a.useState)(0),[k,S]=(0,a.useState)(0),[P,A]=(0,a.useState)(!0),[q,C]=(0,a.useState)(!1),[_,z]=(0,a.useState)([]),[D,$]=(0,a.useState)([]),[L,I]=(0,a.useState)(!0),[E,T]=(0,a.useState)(null),[U,M]=(0,a.useState)([]),[O,F]=(0,a.useState)([]),G=`${u.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")} Quiz - Level ${h}`,J=e=>{let t=Math.floor(e/60);return`${t}:${(e%60).toString().padStart(2,"0")}`},B=(e,t)=>{let s;return 20+Math.max(0,5-Math.floor(e/2))+Math.min(5,t)},Q=e=>{v(e)},R=async()=>{try{if(console.group("Completing Quiz Task"),console.log("Current taskId:",p),console.log("Current score:",j),console.log("Time spent:",k,"seconds"),!p){console.warn("No taskId available, cannot complete task"),console.groupEnd();return}if(p.startsWith("client_")){console.log(`Using temporary task ID ${p}, skipping server update`),console.groupEnd();return}let e=(0,d.c4)();if(!e){console.error("No authentication token available"),console.groupEnd();return}let t=await fetch("/api/tasks",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({taskId:p,TaskScore:j,DurationTask:k,CompletionDate:new Date().toISOString()})});if(t.ok){let e=await t.json();console.log("Successfully completed quiz task:",e)}else{let e=await t.text();console.error(`Failed to complete quiz task (${t.status}):`,e)}console.groupEnd()}catch(e){console.error("Error completing quiz task:",e),console.groupEnd()}};return t||L?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 flex justify-center items-center",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-lg text-center",children:[(0,r.jsx)("div",{className:"inline-block w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-xl font-medium text-gray-700",children:"Loading Quiz..."})]})}):E?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6 flex justify-center items-center",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-2xl shadow-xl text-center",children:[(0,r.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:"❌"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:E}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Please complete the flashcard exercise first to learn some words."}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(o(),{href:`/topics/${u}/tasks/flashcard?level=${h}`,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all duration-300",children:"Go to Flashcards"}),(0,r.jsx)(o(),{href:"#",className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-all duration-300",children:"Back to Topics"})]})]})}):0===U.length?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6 flex justify-center items-center",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-2xl shadow-xl text-center",children:[(0,r.jsx)("div",{className:"text-orange-500 text-5xl mb-4",children:"\uD83D\uDCDA"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No Quiz Questions Available"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Please complete the flashcard exercise first to learn some words."}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(o(),{href:`/topics/${u}/tasks/flashcard?level=${h}`,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all duration-300",children:"Go to Flashcards"}),(0,r.jsx)(o(),{href:"#",className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-all duration-300",children:"Back to Topics"})]})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 relative",dir:"rtl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-6 mt-2",children:G}),(0,r.jsx)("div",{className:"max-w-4xl mx-auto bg-white rounded-2xl p-6 shadow-lg mb-6",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-center transform hover:scale-110 transition-all duration-300",children:[(0,r.jsx)(i.gt3,{className:"text-yellow-500 text-3xl mb-2 mx-auto"}),(0,r.jsx)("div",{className:"text-3xl font-bold text-orange-500 mb-1",children:j}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"ניקוד"})]}),(0,r.jsxs)("div",{className:"text-center transform hover:scale-110 transition-all duration-300",children:[(0,r.jsx)(i.SBv,{className:"text-orange-500 text-3xl mb-2 mx-auto"}),(0,r.jsx)("div",{className:"text-3xl font-bold text-orange-500 mb-1",children:y}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"רצף"})]}),(0,r.jsxs)("div",{className:"text-center transform hover:scale-110 transition-all duration-300",children:[(0,r.jsx)(i.rat,{className:"text-blue-500 text-3xl mb-2 mx-auto"}),(0,r.jsx)("div",{className:"text-3xl font-bold text-orange-500 mb-1",children:J(k)}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"זמן"})]})]})}),(0,r.jsxs)("main",{className:"max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-8",children:[(0,r.jsxs)("div",{className:"bg-orange-50 p-4 rounded-xl mb-6 flex items-center justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-700",children:"בחן את עצמך על המילים שלמדת"})}),(0,r.jsxs)("div",{className:"text-orange-600 font-semibold",children:[U.length," שאלות"]})]}),(0,r.jsxs)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-6",children:["שאלה ",g+1," מתוך ",U.length]}),(0,r.jsxs)("p",{className:"text-xl text-gray-700 mb-8",children:["בחר את התרגום הנכון למילה: ",(0,r.jsx)("span",{className:"font-bold text-2xl text-orange-600",children:U[g].word})]}),(0,r.jsx)("div",{className:"w-full max-w-3xl mx-auto",children:(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:U[g]?.options.map((e,t)=>(0,r.jsx)("button",{onClick:()=>Q(e),className:`p-6 rounded-xl text-lg font-semibold transition-all duration-300 ${f===e?"bg-gradient-to-r from-orange-500 to-red-500 text-white transform scale-105":"bg-white text-gray-700 border-2 border-orange-200 hover:border-orange-400 hover:scale-105"}`,children:e},t))})}),(0,r.jsx)("button",{onClick:()=>{if(U&&0!==U.length&&!(g>=U.length)){if(f===U[g].correctAnswer){let e=y+1;w(e);let t=B(k/(g+1),e);N(e=>e+t),z(e=>[...e,{word:U[g].word,translation:U[g].correctAnswer}])}else w(0),$(e=>[...e,{word:U[g].word,translation:U[g].correctAnswer,userAnswer:f}]);g<U.length-1?(b(e=>e+1),v("")):(A(!1),N(e=>Math.min(200,e+Math.max(0,30-Math.floor(k/20))+20*(y===U.length))),R(),C(!0))}},disabled:!f,className:"mt-8 px-8 py-4 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl text-lg font-semibold hover:from-orange-600 hover:to-red-600 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed w-full md:w-auto",children:"שלח תשובה"})]}),q&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-6",children:"תוצאות המבחן! \uD83C\uDF89"}),(0,r.jsxs)("div",{className:"bg-orange-50 rounded-xl p-6 mb-8",children:[(0,r.jsxs)("p",{className:"text-2xl text-gray-800 font-semibold mb-2",children:["הניקוד שלך: ",(0,r.jsx)("span",{className:"text-orange-600",children:j})," נקודות"]}),(0,r.jsxs)("p",{className:"text-xl text-gray-700 mb-1",children:["תשובות נכונות: ",(0,r.jsx)("span",{className:"text-green-600 font-bold",children:_.length})," מתוך ",U.length," (",Math.round(_.length/U.length*100),"%)"]}),(0,r.jsxs)("p",{className:"text-gray-600 mt-2",children:["זמן שחלף: ",J(k)]}),_.length/U.length<.6&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-4",children:[(0,r.jsx)("p",{className:"text-red-700 font-medium",children:"לא ניתן להמשיך למשימה הבאה עם ציון נמוך מ-60%."}),(0,r.jsxs)("p",{className:"text-red-600 text-sm",children:["אתה צריך לענות נכון על לפחות ",Math.ceil(.6*U.length)," שאלות מתוך ",U.length," כדי להמשיך."]})]})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-green-50 rounded-xl p-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-green-800 mb-3",children:["תשובות נכונות (",_.length,")"]}),_.length>0?(0,r.jsx)("ul",{className:"space-y-2",children:_.map((e,t)=>(0,r.jsxs)("li",{className:"flex justify-between items-center bg-white px-4 py-2 rounded-lg shadow-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:e.word}),(0,r.jsx)("span",{className:"text-green-600",children:e.translation})]},`correct-${t}`))}):(0,r.jsx)("p",{className:"text-gray-500 text-center py-2",children:"אין תשובות נכונות."})]}),(0,r.jsxs)("div",{className:"bg-red-50 rounded-xl p-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-red-800 mb-3",children:["תשובות שגויות (",D.length,")"]}),D.length>0?(0,r.jsx)("ul",{className:"space-y-2",children:D.map((e,t)=>(0,r.jsxs)("li",{className:"flex flex-col bg-white px-4 py-3 rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-medium",children:e.word}),(0,r.jsx)("span",{className:"text-red-600 line-through",children:e.userAnswer})]}),(0,r.jsxs)("div",{className:"text-right text-sm mt-1",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"התשובה הנכונה: "}),(0,r.jsx)("span",{className:"text-green-600 font-medium",children:e.translation})]})]},`incorrect-${t}`))}):(0,r.jsx)("p",{className:"text-gray-500 text-center py-2",children:"אין תשובות שגויות!"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("button",{id:"try-again-btn",onClick:()=>{b(0),v(""),N(0),w(0),S(0),A(!0),C(!1),z([]),$([])},className:"w-full py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all duration-300 transform hover:-translate-y-1 shadow-md hover:shadow-xl",children:"נסה שוב \uD83D\uDD04"}),(0,r.jsx)("button",{onClick:()=>{if(j<.6*U.length){let e=document.getElementById("try-again-btn");e&&(e.classList.add("animate-pulse","ring-4","ring-green-300"),setTimeout(()=>{e.classList.remove("animate-pulse","ring-4","ring-green-300")},2e3));return}if(p){sessionStorage.setItem(`quiz_task_${u}_${h}`,p);try{let e=_.map(e=>e.word);sessionStorage.setItem(`quiz_words_${u}_${h}`,JSON.stringify(e))}catch(e){console.error("Error storing quiz words:",e)}}let e=new URLSearchParams;e.append("level",h),p&&e.append("quizTaskId",p),l.push(`/topics/${u}/tasks/post?${e.toString()}`)},disabled:_.length/U.length<.6,className:`w-full py-3 ${_.length/U.length>=.6?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"} text-white rounded-xl transition-all duration-300 transform hover:-translate-y-1 shadow-md hover:shadow-xl`,children:"האתגר הבא \uD83C\uDFAF"}),_.length/U.length<.6&&(0,r.jsx)("p",{className:"text-red-600 text-sm mt-2",children:"נדרש לפחות 60% תשובות נכונות כדי להמשיך לאתגר הבא"})]})]})})]})}s(27799)},27799:(e,t,s)=>{"use strict";function r(e){return e.includes(" ")&&/[A-Z]/.test(e)?e:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}function a(e){return e.includes("-")&&!/[A-Z]/.test(e)?e:e.toLowerCase().replace(/\s+/g,"-")}s.d(t,{o_:()=>a,x$:()=>r})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34141:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d});var r=s(24332),a=s(48819),n=s(67851),l=s.n(n),o=s(97540),i={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let d={children:["",{children:["topics",{children:["[topicName]",{children:["tasks",{children:["quiz",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,58025)),"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/[topicName]/tasks/quiz/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,97814)),"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/[topicName]/tasks/layout.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,20685)),"/Users/amitnachman/Desktop/280425/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/[topicName]/tasks/quiz/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/topics/[topicName]/tasks/quiz/page",pathname:"/topics/[topicName]/tasks/quiz",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},34935:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,69355,23)),Promise.resolve().then(s.t.bind(s,54439,23)),Promise.resolve().then(s.t.bind(s,67851,23)),Promise.resolve().then(s.t.bind(s,94730,23)),Promise.resolve().then(s.t.bind(s,19774,23)),Promise.resolve().then(s.t.bind(s,53170,23)),Promise.resolve().then(s.t.bind(s,20968,23)),Promise.resolve().then(s.t.bind(s,78298,23))},38504:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},58025:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/[topicName]/tasks/quiz/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/[topicName]/tasks/quiz/page.tsx","default")},58369:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(60159);let a=()=>{let[e,t]=(0,r.useState)({isAuthenticated:!1,isLoading:!0,user:null,error:null});(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(!e)return t({isAuthenticated:!1,isLoading:!1,user:null,error:null});try{let s=await fetch("/api/auth/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),r=await s.json();if(r.success){let e=r.user;if(!e){let t=localStorage.getItem("user");t&&(e=JSON.parse(t))}t({isAuthenticated:!0,isLoading:!1,user:e,error:null})}else localStorage.removeItem("token"),localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:r.message||"Authentication failed"})}catch(e){console.error("Auth validation error:",e),t({isAuthenticated:!1,isLoading:!1,user:null,error:e instanceof Error?e.message:"Authentication error"})}})()},[]);let s=async(e,s)=>{try{t(e=>({...e,isLoading:!0}));let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s})}),a=await r.json();if(a.success)return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),t({isAuthenticated:!0,isLoading:!1,user:a.user,error:null}),{success:!0};return t({isAuthenticated:!1,isLoading:!1,user:null,error:a.message||"Login failed"}),{success:!1,message:a.message||"Login failed"}}catch(s){let e=s instanceof Error?s.message:"An unexpected error occurred";return t({isAuthenticated:!1,isLoading:!1,user:null,error:e}),{success:!1,message:e}}};return{...e,login:s,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t({isAuthenticated:!1,isLoading:!1,user:null,error:null})}}}},62959:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,30385,23)),Promise.resolve().then(s.t.bind(s,33737,23)),Promise.resolve().then(s.t.bind(s,86081,23)),Promise.resolve().then(s.t.bind(s,1904,23)),Promise.resolve().then(s.t.bind(s,35856,23)),Promise.resolve().then(s.t.bind(s,55492,23)),Promise.resolve().then(s.t.bind(s,89082,23)),Promise.resolve().then(s.t.bind(s,45812,23))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70173:(e,t,s)=>{"use strict";function r(){return null}s.d(t,{c4:()=>r}),s(32970)},72022:(e,t,s)=>{Promise.resolve().then(s.bind(s,58025))},74952:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},80408:()=>{},87032:()=>{},97814:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(38828);function a({children:e}){return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{children:e})})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[191,787,989,843,704],()=>s(34141));module.exports=r})();