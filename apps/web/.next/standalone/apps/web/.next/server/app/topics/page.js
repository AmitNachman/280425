(()=>{var e={};e.id=443,e.ids=[443],e.modules={2984:(e,s,t)=>{"use strict";var r=t(860);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},3018:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var r=t(13486),a=t(60159),n=t(2984);let o=({isVisible:e=!1,onClose:s,showIcon:t=!0})=>{let[o,i]=(0,a.useState)(e),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0);(0,n.useRouter)(),(0,a.useEffect)(()=>{i(e)},[e]),(0,a.useEffect)(()=>{let e=async()=>{if(o){u(!0);try{let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found");let s=await fetch("/api/user-profile",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw Error("Failed to fetch user profile");let t=await s.json();c({FirstName:t.FirstName||"",LastName:t.LastName||"",Email:t.Email||"",PhoneNumber:t.PhoneNumber||"",EnglishLevel:t.EnglishLevel||"Not Set",AgeRange:t.AgeRange||"",ProfilePicture:t.ProfilePicture||null,CreationDate:new Date(t.CreationDate),LastLogin:t.LastLogin?new Date(t.LastLogin):void 0,Score:t.Score||0}),u(!1)}catch(e){console.error("Error fetching user data:",e),u(!1)}}};o&&e()},[o]);let h=()=>{let e=!o;i(e),!e&&s&&s()};return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)("div",{className:"absolute top-4 right-4",children:(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-white shadow-lg flex items-center justify-center cursor-pointer hover:shadow-xl transform hover:scale-105 transition-all duration-300",onClick:h,children:l?.ProfilePicture?(0,r.jsx)("img",{src:l.ProfilePicture,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC64"})})}),o&&(0,r.jsxs)("div",{className:"absolute top-20 right-4 bg-white p-6 shadow-2xl rounded-2xl w-80 z-50 border border-gray-100 transform transition-all duration-300",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"User Profile"}),d?(0,r.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):l?(0,r.jsxs)("div",{className:"space-y-3 text-gray-800",children:[l.ProfilePicture&&(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("img",{src:l.ProfilePicture,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-200"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Name:"}),(0,r.jsx)("span",{children:l?.FirstName||l?.LastName?`${l?.FirstName||""} ${l?.LastName||""}`.trim():"Guest User"})]}),(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Email:"}),(0,r.jsx)("span",{className:"text-right",children:l.Email||"Not provided"})]}),(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Phone:"}),(0,r.jsx)("span",{children:l.PhoneNumber||"Not provided"})]}),(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"English Level:"}),(0,r.jsx)("span",{children:l.EnglishLevel})]}),l.AgeRange&&(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Age Range:"}),(0,r.jsx)("span",{children:l.AgeRange})]}),(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Score:"}),(0,r.jsx)("span",{children:l.Score})]}),(0,r.jsxs)("p",{className:"flex justify-between",children:[(0,r.jsx)("strong",{children:"Member Since:"}),(0,r.jsx)("span",{children:l.CreationDate.toLocaleDateString()})]})]})]}):(0,r.jsx)("p",{className:"text-red-500",children:"Failed to load user data"}),(0,r.jsx)("div",{className:"mt-6 space-y-2",children:(0,r.jsx)("button",{className:"w-full py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",onClick:h,children:"Close"})})]})]})},i=({topic:e,userId:s,onError:t})=>{let o=(0,n.useRouter)(),[i,l]=(0,a.useState)(!1),c=async r=>{if(r.preventDefault(),!i){l(!0);try{let t=localStorage.getItem("token");if(!t)throw Error("לא נמצא טוקן אימות - יש להתחבר מחדש");let r=e.TopicName.toLowerCase().replace(/\s+/g,"-");console.log(`מנסה ליצור משימה: userId=${s}, topicName=${r}, token=${t.slice(0,10)}...`);let a=await fetch("/api/tasks",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({UserId:s,TopicName:r,Level:"1",TaskType:"flashcard"})});if(!a.ok){console.error("תגובת שגיאה מהשרת:",a.status,a.statusText);let e=await a.json().catch(()=>({error:"שגיאה לא ידועה"}));throw Error(e.error||`שגיאת שרת: ${a.status}`)}let n=(await a.json()).TaskId;console.log("משימה נוצרה בהצלחה עם מזהה:",n);let i=`/topics/${r}/tasks/flashcard?level=1&taskId=${n}`;console.log(`ניווט אל: ${i}`),o.push(i)}catch(e){console.error("שגיאה בבחירת נושא:",e),e instanceof Error&&(e.message.includes("401")||e.message.includes("אימות")||e.message.includes("להתחבר"))&&(console.log("מזהה שגיאת אימות - מנווט לדף התחברות"),o.push("/login")),t&&t(e instanceof Error?e.message:"אירעה שגיאה בהתחלת פעילות. אנא נסה שוב.")}finally{l(!1)}}};return(0,r.jsx)("div",{onClick:c,className:"group bg-white p-6 rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[i?(0,r.jsx)("div",{className:"w-10 h-10 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"}):(0,r.jsx)("span",{className:"text-4xl group-hover:scale-110 transition-transform duration-300",children:e.Icon||"\uD83C\uDF1F"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2 group-hover:text-orange-600 transition-colors",children:e.TopicName}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:e.TopicHe})]})]})})};var l=t(58369),c=t(17229),d=t(49989),u=t.n(d);function h(){let[e,s]=(0,a.useState)([]),[t,d]=(0,a.useState)({level:"",points:0,totalScore:0,completedTasks:0,activeSince:"",nextLevel:"",pointsToNextLevel:100}),[h,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),{isAuthenticated:g,isLoading:f,user:j}=(0,l.A)(),b=(0,n.useRouter)(),v=e=>{p(e),setTimeout(()=>p(null),5e3)};return f?(0,r.jsx)("div",{children:"Loading..."}):g?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-red-50 p-6 relative",children:[(0,r.jsx)(o,{isVisible:h,onClose:()=>m(!h),showIcon:!0}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-5xl font-bold mb-8 text-center bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:"Choose Your Topic"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-10",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,r.jsx)("span",{className:"text-xl",children:"\uD83C\uDFAF"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Total Score"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:t.totalScore}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"points"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,r.jsx)("span",{className:"text-xl",children:"✅"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Completed Tasks"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:t.completedTasks}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:"activities"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mb-2",children:(0,r.jsx)("span",{className:"text-xl",children:"⏱️"})}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Active Since"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:t.activeSince})]})]}),(0,r.jsx)("div",{className:"flex justify-center mb-8",children:(0,r.jsx)(u(),{href:"/hall-of-fame",children:(0,r.jsxs)("div",{className:"px-6 py-3 bg-gradient-to-r from-amber-400 to-amber-600 text-white font-semibold rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 text-xl",children:"\uD83D\uDC51"}),(0,r.jsx)("span",{children:"Hall of Fame"})]})})}),x&&(0,r.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-6 text-center",children:x}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:e.map(e=>(0,r.jsx)(i,{topic:e,userId:j?.UserId||j?.userId||"",onError:v},e.TopicName))})]}),(0,r.jsx)("div",{className:"absolute top-4 left-4 flex space-x-3",children:(0,r.jsx)("button",{onClick:()=>{(0,c.Tp)(),b.push("/login")},className:"w-12 h-12 rounded-full bg-white shadow-lg flex items-center justify-center hover:shadow-xl transform hover:scale-105 transition-all duration-300",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC4B"})})})]}):null}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14276:()=>{},15517:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=t(24332),a=t(48819),n=t(67851),o=t.n(n),i=t(97540),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(s,l);let c={children:["",{children:["topics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,67849)),"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,20685)),"/Users/amitnachman/Desktop/280425/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/topics/page",pathname:"/topics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},17229:(e,s,t)=>{"use strict";async function r(e,s){try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s})}),r=await t.json();return{success:t.ok,token:r.token,user:r.user,message:r.message,details:r.details}}catch(e){return console.error("Login service error:",e),{success:!1,message:e instanceof Error?e.message:"An unexpected error occurred"}}}async function a(){try{let e=await fetch("/api/health"),s=await e.json();return{isReachable:"online"===s.status,details:s}}catch(e){return{isReachable:!1,details:e instanceof Error?e.message:"Unknown error"}}}function n(e,s){}function o(){}t.d(s,{Bp:()=>a,Lx:()=>r,NR:()=>n,Tp:()=>o})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20685:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>a});var r=t(38828);t(14276);let a={title:"Unity Voice",description:"Unity Voice app"};function n({children:e}){return(0,r.jsx)("html",{lang:"en",children:(0,r.jsx)("body",{className:"antialiased",children:e})})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34935:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,69355,23)),Promise.resolve().then(t.t.bind(t,54439,23)),Promise.resolve().then(t.t.bind(t,67851,23)),Promise.resolve().then(t.t.bind(t,94730,23)),Promise.resolve().then(t.t.bind(t,19774,23)),Promise.resolve().then(t.t.bind(t,53170,23)),Promise.resolve().then(t.t.bind(t,20968,23)),Promise.resolve().then(t.t.bind(t,78298,23))},38504:()=>{},47616:(e,s,t)=>{Promise.resolve().then(t.bind(t,3018))},58369:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var r=t(60159);let a=()=>{let[e,s]=(0,r.useState)({isAuthenticated:!1,isLoading:!0,user:null,error:null});(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(!e)return s({isAuthenticated:!1,isLoading:!1,user:null,error:null});try{let t=await fetch("/api/auth/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),r=await t.json();if(r.success){let e=r.user;if(!e){let s=localStorage.getItem("user");s&&(e=JSON.parse(s))}s({isAuthenticated:!0,isLoading:!1,user:e,error:null})}else localStorage.removeItem("token"),localStorage.removeItem("user"),s({isAuthenticated:!1,isLoading:!1,user:null,error:r.message||"Authentication failed"})}catch(e){console.error("Auth validation error:",e),s({isAuthenticated:!1,isLoading:!1,user:null,error:e instanceof Error?e.message:"Authentication error"})}})()},[]);let t=async(e,t)=>{try{s(e=>({...e,isLoading:!0}));let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await r.json();if(a.success)return localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),s({isAuthenticated:!0,isLoading:!1,user:a.user,error:null}),{success:!0};return s({isAuthenticated:!1,isLoading:!1,user:null,error:a.message||"Login failed"}),{success:!1,message:a.message||"Login failed"}}catch(t){let e=t instanceof Error?t.message:"An unexpected error occurred";return s({isAuthenticated:!1,isLoading:!1,user:null,error:e}),{success:!1,message:e}}};return{...e,login:t,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),s({isAuthenticated:!1,isLoading:!1,user:null,error:null})}}}},60768:(e,s,t)=>{Promise.resolve().then(t.bind(t,67849))},62959:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,30385,23)),Promise.resolve().then(t.t.bind(t,33737,23)),Promise.resolve().then(t.t.bind(t,86081,23)),Promise.resolve().then(t.t.bind(t,1904,23)),Promise.resolve().then(t.t.bind(t,35856,23)),Promise.resolve().then(t.t.bind(t,55492,23)),Promise.resolve().then(t.t.bind(t,89082,23)),Promise.resolve().then(t.t.bind(t,45812,23))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67849:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/amitnachman/Desktop/280425/apps/web/src/app/topics/page.tsx","default")},74952:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[191,787,989],()=>t(15517));module.exports=r})();